\chapter{Continuous gravitational wave injections}

%%%%%%%%%%%%%%%%
In this section I outline how we inject a \ac{CW} signal into data. This can generally be done in two different ways: simulating a signal in the time domain and injecting into time domain noise or simulating the power spectrum of a signal and injecting the signal into a \ac{PSD}.
%%%%%%%%%%%
\subsection{CW Signal}
%%%%%%%%%%%
This section has been covered in Sec.~\ref{intro:cw:signal}, The CW signal in generated by using a lalsuite package where ....

%%%%%%%%%%%%
\subsection{Time series and complex \ac{FFT} injections}
%%%%%%%%%%%%
Injections into time-series data is relatively simple. Given a set of parameters for the source the signal can be generated in the time-series, this is then just summed with the time-series which it is injected into. Similarly with the \ac{FFT}, the time-series of the signal at the correct time and for the correct duration is generated, the complex \acp{FFT} are then summed.

%%%%%%%%%%%%%%%
\subsection{Spectrogram injections}
%%%%%%%%%%%%%

To inject into a spectrogram the power spectrum of the signal will need to be simulated. In our injection we do not have access to a time-series, therefore, we do not simulate the signal in the same way, rather we use the signals estimated \ac{SNR}

It can be shown that the \ac{PSD} of Gaussian noise with zero mean and unit variance is a $\chi^2$ distribution with 2 degrees of freedom. Therefore, if we want to generate a spectrogram for Gaussian noise, we just generate a two dimensional array of values distributed as $\chi^2$ with two degrees of freedom.
Assuming that there is some sinusoidal signal with a given \ac{SNR} within a Gaussian noise time-series with zero mean and unit variance, the \ac{FFT} power in a particular frequency bin can be estimated using a non-central $\chi^2$ distribution with 2 degrees of freedom, where the non centrality parameter is the square of the \ac{SNR}. 
To calculate the \ac{SNR} in a given frequency bin the equation in \citep{Prix2007} for optimal \ac{SNR} was used,
\begin{equation}
    \rho(0)^2 = \frac{1}{2}h_0^2 T S^{-1} \left[ \alpha_1 A + \alpha_2 B + \alpha_3 C \right],
\end{equation}
where $h_0$ is the \ac{GW} amplitude, $T$ is the total observing time is seconds, $S^{-1}$ is the mean \ac{PSD} noise floor. The values of $\alpha$ are then defined by,
\begin{equation}
\begin{split}
\alpha_1 &= (\mathcal{A}^1)^2 + (\mathcal{A}^3)^2\\
\alpha_2 &= (\mathcal{A}^2)^2 + (\mathcal{A}^4)^2 \\
\alpha_3 &= \mathcal{A}^1\mathcal{A}^2 + \mathcal{A}^3\mathcal{A}^4 \\
\end{split}
\end{equation}
<br/>
where,
\begin{equation}
\begin{split}
\mathcal{A}^1 &= A_{+}\cos(2\psi_0)\cos(2\phi) - A_{\times}\sin(2\psi_0)\sin(2\phi) \\
\mathcal{A}^2 &= A_{+}\cos(2\psi_0)\sin(2\phi) + A_{\times}\sin(2\psi_0)\cos(2\phi) \\
\mathcal{A}^3 &= A_{+}\sin(2\psi_0)\cos(2\phi) - A_{\times}\cos(2\psi_0)\sin(2\phi) \\
\mathcal{A}^4 &= A_{+}\sin(2\psi_0)\sin(2\phi) + A_{\times}\cos(2\psi_0)\cos(2\phi) 
\end{split}
\end{equation}
The signals frequency varies with time and will not always be located at the center of a frequency bin, therefore, when taking the \ac{FFT} some of the power is spread over multiple frequency bins. 
In our injections into the power spectrum we need to account for this effect. 
For a given frequency bin width 
